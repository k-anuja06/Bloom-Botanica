import{r as i,b as z,j as e,z as L,B,q as w,A as k,S as I,V as M}from"./index-DOuJ7_mk.js";import{a as G}from"./index-kC8JlUgJ.js";import{a as _,b as H}from"./index-Da9-5BbU.js";import{u as J}from"./UploadImage-rzKfwQBb.js";import{V as K}from"./ViewImage-C63BDXv2.js";import{A as Q,s as W}from"./SuccessAlert-B06Vav86.js";import"./CofirmBox-CqywYNC6.js";const X=({close:s,data:n,fetchProductData:o})=>{const[l,d]=i.useState({_id:n._id,name:n.name,image:n.image||[],category:n.category||[],subCategory:n.subCategory||[],unit:n.unit,stock:n.stock,price:n.price,discount:n.discount,description:n.description,more_details:n.more_details||{}}),[u,m]=i.useState(!1),[g,x]=i.useState(""),[j,p]=i.useState(!1),[v,C]=i.useState(""),[S,c]=i.useState(""),[h,O]=i.useState(""),A=z(t=>t.product.allCategory),P=z(t=>t.product.allSubCategory),f=t=>{const{name:a,value:r}=t.target;d(y=>({...y,[a]:r}))},R=async t=>{var r,y;const a=t.target.files[0];if(a){m(!0);try{const b=await J(a),F=(y=(r=b==null?void 0:b.data)==null?void 0:r.data)==null?void 0:y.url;F&&d(U=>({...U,image:[...U.image,F]}))}catch(b){w(b)}finally{m(!1)}}},T=t=>{d(a=>{const r=[...a.image];return r.splice(t,1),{...a,image:r}})},V=t=>{d(a=>{const r=[...a.category];return r.splice(t,1),{...a,category:r}})},q=t=>{d(a=>{const r=[...a.subCategory];return r.splice(t,1),{...a,subCategory:r}})},D=()=>{v&&(d(t=>({...t,more_details:{...t.more_details,[v]:""}})),C(""),p(!1))},$=async t=>{t.preventDefault();try{const a=await k({...I.updateProductDetails,data:l}),r=a==null?void 0:a.data;r!=null&&r.success&&(W(r.message),s==null||s(),o==null||o())}catch(a){w(a)}};return e.jsx("section",{className:"fixed inset-0 bg-black bg-opacity-70 z-50 p-4",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl h-full max-h-[95vh] mx-auto rounded overflow-y-auto p-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-2 shadow-md bg-white",children:[e.jsx("h2",{className:"font-semibold",children:"Upload Product"}),e.jsx("button",{onClick:s,children:e.jsx(_,{size:20})})]}),e.jsxs("form",{onSubmit:$,className:"grid gap-4 p-3",children:[e.jsx(N,{id:"name",label:"Name",name:"name",value:l.name,onChange:f}),e.jsx(Y,{id:"description",label:"Description",name:"description",value:l.description,onChange:f}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"font-medium",children:"Image"}),e.jsxs("label",{htmlFor:"productImage",className:"bg-green-50 h-24 border rounded flex justify-center items-center cursor-pointer",children:[u?e.jsx(L,{}):e.jsx(Z,{}),e.jsx("input",{id:"productImage",type:"file",accept:"image/*",onChange:R,className:"hidden"})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:l.image.map((t,a)=>e.jsx(ee,{src:t,onDelete:()=>T(a),onView:()=>x(t)},t+a))})]}),e.jsx(E,{label:"Category",value:S,options:A,onChange:t=>{const a=A.find(r=>r._id===t.target.value);a&&d(r=>({...r,category:[...r.category,a]})),c("")},selectedItems:l.category,onRemove:V}),e.jsx(E,{label:"Sub Category",value:h,options:P,onChange:t=>{const a=P.find(r=>r._id===t.target.value);a&&d(r=>({...r,subCategory:[...r.subCategory,a]})),O("")},selectedItems:l.subCategory,onRemove:q}),e.jsx(N,{id:"unit",label:"Unit",name:"unit",value:l.unit,onChange:f}),e.jsx(N,{id:"stock",label:"Number of Stock",name:"stock",type:"number",value:l.stock,onChange:f}),e.jsx(N,{id:"price",label:"Price",name:"price",type:"number",value:l.price,onChange:f}),e.jsx(N,{id:"discount",label:"Discount",name:"discount",type:"number",value:l.discount,onChange:f}),Object.entries(l.more_details).map(([t,a])=>e.jsx(N,{id:t,label:t,value:a,onChange:r=>{const y=r.target.value;d(b=>({...b,more_details:{...b.more_details,[t]:y}}))}},t)),e.jsx("div",{onClick:()=>p(!0),className:"w-32 py-1 px-3 text-center font-semibold border rounded bg-white hover:bg-primary-200 cursor-pointer",children:"Add Fields"}),e.jsx("button",{type:"submit",className:"bg-primary-100 hover:bg-primary-200 py-2 rounded font-semibold",children:"Update Product"})]}),g&&e.jsx(K,{url:g,close:()=>x("")}),j&&e.jsx(Q,{value:v,onChange:t=>C(t.target.value),submit:D,close:()=>p(!1)})]})})},N=({id:s,label:n,...o})=>e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{htmlFor:s,className:"font-medium",children:n}),e.jsx("input",{id:s,...o,className:"bg-green-50 p-2 outline-none border rounded",required:!0})]}),Y=({id:s,label:n,...o})=>e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{htmlFor:s,className:"font-medium",children:n}),e.jsx("textarea",{id:s,rows:3,...o,className:"bg-green-50 p-2 outline-none border rounded resize-none",required:!0})]}),Z=()=>e.jsxs("div",{className:"text-center flex flex-col items-center",children:[e.jsx(B,{size:35}),e.jsx("p",{children:"Upload Image"})]}),ee=({src:s,onDelete:n,onView:o})=>e.jsxs("div",{className:"h-20 w-20 bg-green-50 border relative group",children:[e.jsx("img",{src:s,alt:"Product",className:"w-full h-full object-scale-down cursor-pointer",onClick:o}),e.jsx("div",{onClick:n,className:"absolute bottom-0 right-0 p-1 bg-red-600 text-white rounded hidden group-hover:block cursor-pointer",children:e.jsx(G,{})})]}),E=({label:s,value:n,options:o,onChange:l,selectedItems:d,onRemove:u})=>e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"font-medium",children:s}),e.jsxs("select",{className:"bg-green-50 border w-full p-2 rounded",value:n,onChange:l,children:[e.jsxs("option",{value:"",children:["Select ",s]}),o.map(m=>e.jsx("option",{value:m._id,children:m.name},m._id))]}),e.jsx("div",{className:"flex flex-wrap gap-3 mt-2",children:d.map((m,g)=>e.jsxs("div",{className:"text-sm flex items-center gap-1 bg-green-50 p-1 rounded",children:[e.jsx("span",{children:m.name}),e.jsx(_,{size:18,className:"cursor-pointer hover:text-red-500",onClick:()=>u(g)})]},`${m._id}-${g}`))})]}),se=({data:s,fetchProductData:n})=>{const[o,l]=i.useState(!1),[d,u]=i.useState(!1),m=i.useCallback(async()=>{try{const x=await k({...I.deleteProduct,data:{_id:s._id}}),{data:j}=x;j.success&&(M.success(j.message),n&&n(),u(!1))}catch(x){w(x)}},[s._id,n]),g=()=>u(!1);return e.jsxs("div",{className:"w-36 p-4 bg-white rounded",children:[e.jsx("div",{children:e.jsx("img",{src:s==null?void 0:s.image[0],alt:s==null?void 0:s.name,className:"w-full h-full object-scale-down"})}),e.jsx("p",{className:"text-ellipsis line-clamp-2 font-medium",children:s==null?void 0:s.name}),e.jsx("p",{className:"text-slate-400",children:s==null?void 0:s.unit}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 py-2",children:[e.jsx("button",{onClick:()=>l(!0),className:"border px-1 py-1 text-sm border-green-600 bg-green-100 text-green-800 hover:bg-green-200 rounded",children:"Edit"}),e.jsx("button",{onClick:()=>u(!0),className:"border px-1 py-1 text-sm border-red-600 bg-red-100 text-red-600 hover:bg-red-200 rounded",children:"Delete"})]}),o&&e.jsx(X,{fetchProductData:n,data:s,close:()=>l(!1)}),d&&e.jsx("section",{className:"fixed top-0 left-0 right-0 bottom-0 bg-neutral-600 z-50 bg-opacity-70 p-4 flex justify-center items-center",children:e.jsxs("div",{className:"bg-white p-4 w-full max-w-md rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("h3",{className:"font-semibold",children:"Permanent Delete"}),e.jsx("button",{onClick:g,children:e.jsx(_,{size:25})})]}),e.jsx("p",{className:"my-2",children:"Are you sure you want to delete permanently?"}),e.jsxs("div",{className:"flex justify-end gap-5 py-4",children:[e.jsx("button",{onClick:g,className:"border px-3 py-1 rounded bg-red-100 border-red-500 text-red-500 hover:bg-red-200",children:"Cancel"}),e.jsx("button",{onClick:m,className:"border px-3 py-1 rounded bg-green-100 border-green-500 text-green-500 hover:bg-green-200",children:"Delete"})]})]})})]})},ce=()=>{const[s,n]=i.useState([]),[o,l]=i.useState(1),[d,u]=i.useState(!1),[m,g]=i.useState(1),[x,j]=i.useState(""),p=async()=>{try{u(!0);const c=await k({...I.getProduct,data:{page:o,limit:12,search:x}}),{data:h}=c;h.success&&(g(h.totalNoPage),n(h.data))}catch(c){w(c)}finally{u(!1)}};i.useEffect(()=>{p()},[o]);const v=()=>{o!==m&&l(c=>c+1)},C=()=>{o>1&&l(c=>c-1)},S=c=>{const{value:h}=c.target;j(h),l(1)};return i.useEffect(()=>{let c=!0;const h=setTimeout(()=>{c&&(p(),c=!1)},300);return()=>{clearTimeout(h)}},[x]),e.jsxs("section",{className:"",children:[e.jsxs("div",{className:"p-2  bg-white shadow-md flex items-center justify-between gap-4",children:[e.jsx("h2",{className:"font-semibold",children:"Product"}),e.jsxs("div",{className:"h-full min-w-24 max-w-56 w-full ml-auto bg-green-50 px-4 flex items-center gap-3 py-2 rounded  border focus-within:border-primary-200",children:[e.jsx(H,{size:25}),e.jsx("input",{type:"text",placeholder:"Search product here ...",className:"h-full w-full  outline-none bg-transparent",value:x,onChange:S})]})]}),d&&e.jsx(L,{}),e.jsxs("div",{className:"p-4 bg-green-50",children:[e.jsx("div",{className:"min-h-[55vh]",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:s.map((c,h)=>e.jsx(se,{data:c,fetchProductData:p}))})}),e.jsxs("div",{className:"flex justify-between my-4",children:[e.jsx("button",{onClick:C,className:"border border-primary-200 px-4 py-1 hover:bg-primary-200",children:"Previous"}),e.jsxs("button",{className:"w-full bg-slate-100",children:[o,"/",m]}),e.jsx("button",{onClick:v,className:"border border-primary-200 px-4 py-1 hover:bg-primary-200",children:"Next"})]})]})]})};export{ce as default};
